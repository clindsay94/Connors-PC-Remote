<Page
    x:Class="CPCRemote.UI.Pages.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:CommunityToolkit.WinUI.Controls"
    xmlns:viewmodels="using:CPCRemote.UI.ViewModels"
    mc:Ignorable="d"
    Background="Transparent">

    <Page.Transitions>
        <TransitionCollection>
            <EntranceThemeTransition />
        </TransitionCollection>
    </Page.Transitions>

    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="24">
        <StackPanel Spacing="4" MaxWidth="800">
            <TextBlock Text="Settings" Style="{StaticResource HyperTitleTextBlockStyle}" Margin="0,0,0,16"/>

            <!-- APPEARANCE -->
            <TextBlock Text="Appearance" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,16,0,4"/>
            
            <controls:SettingsCard Header="App theme" Description="Select which app theme to display">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE790;"/></controls:SettingsCard.HeaderIcon>
                <controls:Segmented SelectionMode="Single" SelectedItem="{x:Bind ViewModel.AppTheme, Mode=TwoWay, Converter={StaticResource SegmentedStringConverter}}">
                    <controls:SegmentedItem Content="Light" Tag="Light"><controls:SegmentedItem.Icon><FontIcon Glyph="&#xE706;"/></controls:SegmentedItem.Icon></controls:SegmentedItem>
                    <controls:SegmentedItem Content="Dark" Tag="Dark"><controls:SegmentedItem.Icon><FontIcon Glyph="&#xE708;"/></controls:SegmentedItem.Icon></controls:SegmentedItem>
                    <controls:SegmentedItem Content="System" Tag="System"><controls:SegmentedItem.Icon><FontIcon Glyph="&#xE770;"/></controls:SegmentedItem.Icon></controls:SegmentedItem>
                </controls:Segmented>
            </controls:SettingsCard>

            <controls:SettingsExpander Header="Accent color" Description="Customize the app's accent color">
                <controls:SettingsExpander.HeaderIcon><FontIcon Glyph="&#xE790;"/></controls:SettingsExpander.HeaderIcon>
                <controls:SettingsExpander.Items>
                    <controls:SettingsCard Header="Use Windows accent color">
                        <ToggleSwitch IsOn="{x:Bind ViewModel.UseSystemAccent, Mode=TwoWay}"/>
                    </controls:SettingsCard>
                    <controls:SettingsCard Header="Custom accent color">
                        <Button Content="Pick Color">
                            <Button.Flyout>
                                <Flyout>
                                    <ColorPicker x:Name="AccentColorPicker"
                                                 IsColorSliderVisible="True" 
                                                 IsHexInputVisible="True"
                                                 IsAlphaEnabled="False"
                                                 ColorChanged="ColorPicker_ColorChanged"/>
                                </Flyout>
                            </Button.Flyout>
                        </Button>
                    </controls:SettingsCard>
                </controls:SettingsExpander.Items>
            </controls:SettingsExpander>

            <controls:SettingsCard Header="Window backdrop" Description="Choose the window background material">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE71C;"/></controls:SettingsCard.HeaderIcon>
                <ComboBox SelectedValue="{x:Bind ViewModel.Backdrop, Mode=TwoWay}" SelectedValuePath="Tag">
                    <ComboBoxItem Content="Mica" Tag="Mica"/>
                    <ComboBoxItem Content="Mica Alt" Tag="MicaAlt"/>
                    <ComboBoxItem Content="Acrylic" Tag="Acrylic"/>
                    <ComboBoxItem Content="None" Tag="None"/>
                </ComboBox>
            </controls:SettingsCard>

            <!-- TYPOGRAPHY -->
            <TextBlock Text="Typography" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,24,0,4"/>
            
            <controls:SettingsCard Header="Font family" Description="Choose the font used throughout the app">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE8D2;"/></controls:SettingsCard.HeaderIcon>
                <ComboBox ItemsSource="{x:Bind ViewModel.InstalledFonts, Mode=OneWay}" SelectedItem="{x:Bind ViewModel.SelectedFontFamily, Mode=TwoWay}" MinWidth="200" MaxDropDownHeight="400"/>
            </controls:SettingsCard>

            <controls:SettingsCard Header="Text size" Description="Adjust the base text size">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE8E9;"/></controls:SettingsCard.HeaderIcon>
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <Slider Minimum="80" Maximum="150" Value="{x:Bind ViewModel.FontSizeScale, Mode=TwoWay}" Width="150"/>
                    <TextBlock Text="{x:Bind ViewModel.FontSizeScale, Mode=OneWay}" VerticalAlignment="Center" MinWidth="40"/>
                    <TextBlock Text="%" VerticalAlignment="Center"/>
                </StackPanel>
            </controls:SettingsCard>

            <!-- BEHAVIOR -->
            <TextBlock Text="Behavior" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,24,0,4"/>

            <controls:SettingsCard Header="Confirmation dialogs" Description="Show confirmation before power commands">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE7BA;"/></controls:SettingsCard.HeaderIcon>
                <ToggleSwitch IsOn="{x:Bind ViewModel.ShowConfirmations, Mode=TwoWay}"/>
            </controls:SettingsCard>

            <controls:SettingsCard Header="Auto-connect to service" Description="Connect on startup">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE703;"/></controls:SettingsCard.HeaderIcon>
                <ToggleSwitch IsOn="{x:Bind ViewModel.AutoConnect, Mode=TwoWay}"/>
            </controls:SettingsCard>

            <controls:SettingsCard Header="Sound effects" Description="Play sounds for actions">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE767;"/></controls:SettingsCard.HeaderIcon>
                <ToggleSwitch IsOn="{x:Bind ViewModel.SoundEffects, Mode=TwoWay}"/>
            </controls:SettingsCard>
            
            <!-- DASHBOARD -->
            <TextBlock Text="Dashboard" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,24,0,4"/>
            
            <controls:SettingsCard Header="Stats refresh interval" Description="Seconds between updates">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE895;"/></controls:SettingsCard.HeaderIcon>
                <ComboBox SelectedValue="{x:Bind ViewModel.RefreshInterval, Mode=TwoWay}" SelectedValuePath="Tag" MinWidth="120">
                     <ComboBoxItem Content="1 second" Tag="1" />
                     <ComboBoxItem Content="2 seconds" Tag="2" />
                     <ComboBoxItem Content="5 seconds" Tag="5" />
                     <ComboBoxItem Content="10 seconds" Tag="10" />
                     <ComboBoxItem Content="30 seconds" Tag="30" />
                </ComboBox>
            </controls:SettingsCard>

             <controls:SettingsCard Header="Temperature unit" Description="Celsius or Fahrenheit">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE9CA;"/></controls:SettingsCard.HeaderIcon>
                <controls:Segmented SelectedItem="{x:Bind ViewModel.TemperatureUnit, Mode=TwoWay, Converter={StaticResource SegmentedStringConverter}}">
                    <controls:SegmentedItem Content="°C" Tag="Celsius"/>
                    <controls:SegmentedItem Content="°F" Tag="Fahrenheit"/>
                </controls:Segmented>
            </controls:SettingsCard>
            
            <controls:SettingsCard Header="Dashboard animations" Description="Enable animated gauges">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE805;"/></controls:SettingsCard.HeaderIcon>
                <ToggleSwitch IsOn="{x:Bind ViewModel.DashboardAnimations, Mode=TwoWay}"/>
            </controls:SettingsCard>

            <!-- WINDOW -->
            <TextBlock Text="Window" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,24,0,4"/>

            <controls:SettingsCard Header="Always on top" Description="Keep window above others">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE718;"/></controls:SettingsCard.HeaderIcon>
                <ToggleSwitch IsOn="{x:Bind ViewModel.AlwaysOnTop, Mode=TwoWay}"/>
            </controls:SettingsCard>

            <controls:SettingsCard Header="Start minimized" Description="Start in system tray">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE921;"/></controls:SettingsCard.HeaderIcon>
                <ToggleSwitch IsOn="{x:Bind ViewModel.StartMinimized, Mode=TwoWay}"/>
            </controls:SettingsCard>
            
             <controls:SettingsCard Header="Remember window position" Description="Restore position on startup">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE8A0;"/></controls:SettingsCard.HeaderIcon>
                <ToggleSwitch IsOn="{x:Bind ViewModel.RememberPosition, Mode=TwoWay}"/>
            </controls:SettingsCard>
            
             <!-- RESET -->
            <TextBlock Text="Reset" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,24,0,4"/>
            <controls:SettingsCard Header="Reset all settings" Description="Restore defaults" IsClickEnabled="True" Command="{x:Bind ViewModel.ResetSettingsCommand}">
                <controls:SettingsCard.HeaderIcon><FontIcon Glyph="&#xE777;"/></controls:SettingsCard.HeaderIcon>
                <Button Content="Reset" Style="{StaticResource AccentButtonStyle}" Command="{x:Bind ViewModel.ResetSettingsCommand}"/>
            </controls:SettingsCard>
            
            <!-- ABOUT -->
            <TextBlock Text="About" Style="{StaticResource BodyStrongTextBlockStyle}" Margin="0,24,0,4"/>
             <controls:SettingsExpander Header="CPC Remote" Description="Control your Windows PC from SmartThings">
                <controls:SettingsExpander.HeaderIcon><FontIcon Glyph="&#xE946;"/></controls:SettingsExpander.HeaderIcon>
                <controls:SettingsExpander.Items>
                    <controls:SettingsCard Header="Version"><TextBlock Text="{x:Bind ViewModel.VersionString}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/></controls:SettingsCard>
                    <controls:SettingsCard Header=".NET Runtime"><TextBlock Text="{x:Bind ViewModel.RuntimeString}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/></controls:SettingsCard>
                    <controls:SettingsCard Header="Source code" IsClickEnabled="True" Command="{x:Bind ViewModel.OpenGitHubCommand}"><FontIcon Glyph="&#xE8A7;"/></controls:SettingsCard>
                </controls:SettingsExpander.Items>
            </controls:SettingsExpander>

        </StackPanel>
    </ScrollViewer>
</Page>
